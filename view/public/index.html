<html>
	<head>
		<script type="text/javascript" src="https://www.google.com/jsapi"></script>
		<script type="text/javascript" src="vendor/jquery/dist/jquery.min.js"></script>
		<script type="text/javascript">
			//load file and parse it
			values = [
				['t', 'k_tot', 'no_pms'],
			];
			$.get('out_chart.log',
				function(data){
					//format:
					//k1-n1,k2-n2,k3-n3,...
					$.each(data.split(','),
						function(index, value){
							if(!value){
								//the string could be empty
								return;
							}

							bits = value.split('-');
							kxvcpu = parseInt(bits[0]);
							no_pms = parseInt(bits[1]);
							values.push(['t' + index, kxvcpu, no_pms]);
						}
					);
				}
			);

			google.load("visualization", "1", {packages:["corechart"]});
			google.setOnLoadCallback(drawChart);
			function drawChart() {
				var data = google.visualization.arrayToDataTable(values);

				var TOT_K_COL = '#F44336';
				var NO_PMS_COL = '#3F51B5';

				var options = {
					title: 'Simulation History',
					curveType: 'function',
					series: {
						0: {targetAxisIndex: 0},
						1: {targetAxisIndex: 1}
					},
					hAxis: {showTextEvery: 10},
					vAxes:{
						0: {
							title:'Total Consumption',
						},
						1: {
							title:'Number of PMs',
						}
					},
					colors: [TOT_K_COL, NO_PMS_COL, 'black']
				};

				var chart = new google.visualization.LineChart(document.getElementById('chart_div'));

				chart.draw(data, options);
			}
		</script>
	</head>
	<body>
		<div id="chart_div" style="height: 80vh;"></div>

		<ul>
			<li><a href="logs/compute.log">compute.log</a></li>
			<li><a href="logs/scheduler.log">scheduler.log</a></li>
			<li><a href="logs/consolidator.log">consolidator.log</a></li>
			<li><a href="logs/db.log">db.log</a></li>
		</ul>
	</body>
</html>
